#Database Geonames: http://download.geonames.org/export/dump/
#The data format is tab-delimited text in utf8 encoding.
curl -O -L http://download.geonames.org/export/dump/allCountries.zip
unzip allCountries.zip
rm allCountries.zip

# Import MySql
mysqlimport -h localhost -u root -proot --fields-terminated-by='\t' --lines-terminated-by='\n' --local poc-search allCountries.txt
# ou avec Spring Batch
mvn exec:java -Dexec.mainClass=org.springframework.batch.core.launch.support.CommandLineJobRunner -Dexec.args="jobs.xml geonameJob"

# Indexation ElasticSearch
mvn exec:java -Dexec.mainClass=org.springframework.batch.core.launch.support.CommandLineJobRunner -Dexec.args="jobs.xml esJob"

# Query geo_distance
{
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      },
      "filter": {
        "geo_distance": {
          "distance": "100km",
          "location": {
            "lat": 42,
            "lon": 1.6
          }
        }
      }
    }
  }
}